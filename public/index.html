<!DOCTYPE html>
<html>
<head>
    <title>Service Workers: Caching</title>
    <meta name="theme-color" content="#2E3AA1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link defer rel="manifest" href="/manifest.json">
</head>
<body>
<h1>Caching</h1>
<p id="holder"></p>
<noscript>
    <h2>So, I heard you don't like JavaScript?</h2>
    <p>
        That's cool. I'm still here for you. I even got this cool little image
        of a bridge I want to show you.
    </p>
    <p>
        <img border="1" width="500" height="400" src="/assets/bridge.jpg" alt="A bridge">
    </p>
</noscript>
<p>
    <small>
        <strong>Pro tip! </strong>
        Examine the console for service worker activity
    </small>
</p>
<script type="text/javascript">
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker
      .register('./serviceworker.js', {scope: './'})
      .then(navigator.serviceWorker.ready)
      .then((registration) => {
        if (registration.active) {
          console.info('Service Worker is active');
        }
        if (registration.waiting) {
          console.info('Service Worker is in waiting mode');
        }
        if (registration.installing) {
          console.info('Service Worker is installing');
        }
      });
  }

  if ('storageQuota' in navigator) {
    navigator.storageQuota.queryInfo("temporary").then(function (info) {
      console.log('quota in bytes', info.quota);
      console.log('used data in bytes', info.usage);
    });
  }

  // images
  const img = new Image(),
    url = "/assets/bridge.jpg",
    container = document.querySelector("#holder");
  img.width=500;
  img.height=400;
  img.border=1;
  setTimeout(() => {
    img.src = url;
    img.alt = "A bridge";
    img.onload = () => container.appendChild(img);
  }, 100)
</script>
</body>
</html>
