<!DOCTYPE html>
<html>
<head>
    <title>Service Workers: Caching</title>
    <meta name="theme-color" content="#2E3AA1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="/manifest.json">

</head>
<body>
<div>
    <div class="row-head">
        <div class="header-left">
          <span class="logo"></span>
        </div>
        <div class="header-right">
            s√∏keboks
        </div>
    </div>

    <div class="row animated fadeIn">
        <div class="frontpage-block">

            <h1 tabindex="0">Caching</h1>
            <p class="holder"></p>
            <noscript>
                <link href="https://fonts.googleapis.com/css?family=Droid+Sans|Sorts+Mill+Goudy" rel="stylesheet">
                <link rel="stylesheet" href="/assets/app.css" media="screen">
                <h2>So, I heard you don't like JavaScript?</h2>
                <p>
                    That's cool. I'm still here for you. I even got this cool little image
                    of a bridge I want to show you.
                </p>
                <p>
                    <img border="1" width="500" height="400" src="/assets/bridge.jpg" alt="A bridge">
                </p>
            </noscript>

            <p tabindex="0">
                <small>
                    <strong>Pro tip! </strong>
                    Examine the console for service worker activity
                </small>
            </p>

        </div>
    </div>

</div>

<script type="text/javascript">
  const appendStylesheet = href => {
    let stylesheet = document.createElement('link');
    stylesheet.href = href;
    stylesheet.rel = 'stylesheet';
    stylesheet.type = 'text/css';
    document.getElementsByTagName('head')[0].appendChild(stylesheet);
  };
  appendStylesheet('/assets/app.css');
  appendStylesheet('//fonts.googleapis.com/css?family=Droid+Sans|Sorts+Mill+Goudy');

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker
      .register('./serviceworker.js', {scope: './'})
      .then(navigator.serviceWorker.ready)
      .then((registration) => {
        if (registration.active) {
          console.info('Service Worker is active');
        }
        if (registration.waiting) {
          console.info('Service Worker is in waiting mode');
        }
        if (registration.installing) {
          console.info('Service Worker is installing');
        }
      });
  }

  if ('storageQuota' in navigator) {
    navigator.storageQuota.queryInfo("temporary").then(function (info) {
      console.log('quota in bytes', info.quota);
      console.log('used data in bytes', info.usage);
    });
  }

  const asyncLoadImages = ({node, src, width, height, border}) => {
    const img = new Image();
    const container = document.querySelector(node);
    img.width = width;
    img.height = height;
    img.border = border;
      img.src = src;
      img.alt = "A bridge";
      img.onload = (e) => container.appendChild(img);
  };
  asyncLoadImages({node: '.logo', src: '/assets/logo.png', width: 133, height: 40, border: 0});
  asyncLoadImages({node: '.holder', src: '/assets/bridge.jpg', width: 500, height: 400, border: 1});

</script>

<script defer src="//cdn.rawgit.com/amark/gun/master/gun.js"></script>

</body>
</html>
